{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":41},"end":{"line":2,"column":69,"index":110}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"getDeviceId\", {\n    enumerable: true,\n    get: function () {\n      return getDeviceId;\n    }\n  });\n  Object.defineProperty(exports, \"trackEvent\", {\n    enumerable: true,\n    get: function () {\n      return trackEvent;\n    }\n  });\n  Object.defineProperty(exports, \"trackAppOpen\", {\n    enumerable: true,\n    get: function () {\n      return trackAppOpen;\n    }\n  });\n  Object.defineProperty(exports, \"trackAdClick\", {\n    enumerable: true,\n    get: function () {\n      return trackAdClick;\n    }\n  });\n  Object.defineProperty(exports, \"trackAffiliateClick\", {\n    enumerable: true,\n    get: function () {\n      return trackAffiliateClick;\n    }\n  });\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[0], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const DEVICE_ID_KEY = \"@optical_rx_device_id\";\n\n  // Generate or retrieve a persistent device ID\n  const getDeviceId = async () => {\n    try {\n      let deviceId = await AsyncStorage.default.getItem(DEVICE_ID_KEY);\n      if (!deviceId) {\n        // Generate a unique ID for this device\n        deviceId = `${Platform.default.OS}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        await AsyncStorage.default.setItem(DEVICE_ID_KEY, deviceId);\n      }\n      return deviceId;\n    } catch {\n      return `temp-${Date.now()}`;\n    }\n  };\n\n  // Track analytics event\n  const trackEvent = async (eventType, metadata) => {\n    try {\n      const deviceId = await getDeviceId();\n      const platform = Platform.default.OS; // 'ios', 'android', or 'web'\n\n      await fetch(`${BACKEND_URL}/api/analytics/track`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          device_id: deviceId,\n          event_type: eventType,\n          platform: platform,\n          app_version: \"1.0.0\",\n          metadata: metadata\n        })\n      });\n    } catch (error) {\n      // Silently fail - don't interrupt user experience\n      console.log(\"Analytics error:\", error);\n    }\n  };\n\n  // Track app open (call on app launch)\n  const trackAppOpen = () => trackEvent(\"app_open\");\n\n  // Track ad click\n  const trackAdClick = adId => trackEvent(\"ad_click\", {\n    ad_id: adId\n  });\n\n  // Track affiliate click\n  const trackAffiliateClick = partnerId => trackEvent(\"affiliate_click\", {\n    partner_id: partnerId\n  });\n});","lineCount":101,"map":[[12,2,8,0,"Object"],[12,8,8,0],[12,9,8,0,"defineProperty"],[12,23,8,0],[12,24,8,0,"exports"],[12,31,8,0],[13,4,8,0,"enumerable"],[13,14,8,0],[14,4,8,0,"get"],[14,7,8,0],[14,18,8,0,"get"],[14,19,8,0],[15,6,8,0],[15,13,8,0,"getDeviceId"],[15,24,8,0],[16,4,8,0],[17,2,8,0],[18,2,23,0,"Object"],[18,8,23,0],[18,9,23,0,"defineProperty"],[18,23,23,0],[18,24,23,0,"exports"],[18,31,23,0],[19,4,23,0,"enumerable"],[19,14,23,0],[20,4,23,0,"get"],[20,7,23,0],[20,18,23,0,"get"],[20,19,23,0],[21,6,23,0],[21,13,23,0,"trackEvent"],[21,23,23,0],[22,4,23,0],[23,2,23,0],[24,2,49,0,"Object"],[24,8,49,0],[24,9,49,0,"defineProperty"],[24,23,49,0],[24,24,49,0,"exports"],[24,31,49,0],[25,4,49,0,"enumerable"],[25,14,49,0],[26,4,49,0,"get"],[26,7,49,0],[26,18,49,0,"get"],[26,19,49,0],[27,6,49,0],[27,13,49,0,"trackAppOpen"],[27,25,49,0],[28,4,49,0],[29,2,49,0],[30,2,52,0,"Object"],[30,8,52,0],[30,9,52,0,"defineProperty"],[30,23,52,0],[30,24,52,0,"exports"],[30,31,52,0],[31,4,52,0,"enumerable"],[31,14,52,0],[32,4,52,0,"get"],[32,7,52,0],[32,18,52,0,"get"],[32,19,52,0],[33,6,52,0],[33,13,52,0,"trackAdClick"],[33,25,52,0],[34,4,52,0],[35,2,52,0],[36,2,55,0,"Object"],[36,8,55,0],[36,9,55,0,"defineProperty"],[36,23,55,0],[36,24,55,0,"exports"],[36,31,55,0],[37,4,55,0,"enumerable"],[37,14,55,0],[38,4,55,0,"get"],[38,7,55,0],[38,18,55,0,"get"],[38,19,55,0],[39,6,55,0],[39,13,55,0,"trackAffiliateClick"],[39,32,55,0],[40,4,55,0],[41,2,55,0],[42,2,56,59],[42,6,56,59,"_reactNativeWebDistExportsPlatform"],[42,40,56,59],[42,43,56,59,"require"],[42,50,56,59],[42,51,56,59,"_dependencyMap"],[42,65,56,59],[43,2,56,59],[43,6,56,59,"Platform"],[43,14,56,59],[43,17,56,59,"_interopDefault"],[43,32,56,59],[43,33,56,59,"_reactNativeWebDistExportsPlatform"],[43,67,56,59],[44,2,2,0],[44,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[44,42,2,0],[44,45,2,0,"require"],[44,52,2,0],[44,53,2,0,"_dependencyMap"],[44,67,2,0],[45,2,2,0],[45,6,2,0,"AsyncStorage"],[45,18,2,0],[45,21,2,0,"_interopDefault"],[45,36,2,0],[45,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[45,73,2,0],[46,2,4,0],[46,8,4,6,"BACKEND_URL"],[46,19,4,17],[46,22,4,20,"process"],[46,29,4,27],[46,30,4,28,"env"],[46,33,4,31],[46,34,4,32,"EXPO_PUBLIC_BACKEND_URL"],[46,57,4,55],[47,2,5,0],[47,8,5,6,"DEVICE_ID_KEY"],[47,21,5,19],[47,24,5,22],[47,47,5,45],[49,2,7,0],[50,2,8,7],[50,8,8,13,"getDeviceId"],[50,19,8,24],[50,22,8,27],[50,28,8,27,"getDeviceId"],[50,29,8,27],[50,34,8,56],[51,4,9,2],[51,8,9,6],[52,6,10,4],[52,10,10,8,"deviceId"],[52,18,10,16],[52,21,10,19],[52,27,10,25,"AsyncStorage"],[52,39,10,37],[52,40,10,37,"default"],[52,47,10,37],[52,48,10,38,"getItem"],[52,55,10,45],[52,56,10,46,"DEVICE_ID_KEY"],[52,69,10,59],[52,70,10,60],[53,6,11,4],[53,10,11,8],[53,11,11,9,"deviceId"],[53,19,11,17],[53,21,11,19],[54,8,12,6],[55,8,13,6,"deviceId"],[55,16,13,14],[55,19,13,17],[55,22,13,20,"Platform"],[55,30,13,28],[55,31,13,28,"default"],[55,38,13,28],[55,39,13,29,"OS"],[55,41,13,31],[55,45,13,35,"Date"],[55,49,13,39],[55,50,13,40,"now"],[55,53,13,43],[55,54,13,44],[55,55,13,45],[55,59,13,49,"Math"],[55,63,13,53],[55,64,13,54,"random"],[55,70,13,60],[55,71,13,61],[55,72,13,62],[55,73,13,63,"toString"],[55,81,13,71],[55,82,13,72],[55,84,13,74],[55,85,13,75],[55,86,13,76,"substr"],[55,92,13,82],[55,93,13,83],[55,94,13,84],[55,96,13,86],[55,97,13,87],[55,98,13,88],[55,100,13,90],[56,8,14,6],[56,14,14,12,"AsyncStorage"],[56,26,14,24],[56,27,14,24,"default"],[56,34,14,24],[56,35,14,25,"setItem"],[56,42,14,32],[56,43,14,33,"DEVICE_ID_KEY"],[56,56,14,46],[56,58,14,48,"deviceId"],[56,66,14,56],[56,67,14,57],[57,6,15,4],[58,6,16,4],[58,13,16,11,"deviceId"],[58,21,16,19],[59,4,17,2],[59,5,17,3],[59,6,17,4],[59,12,17,10],[60,6,18,4],[60,13,18,11],[60,21,18,19,"Date"],[60,25,18,23],[60,26,18,24,"now"],[60,29,18,27],[60,30,18,28],[60,31,18,29],[60,33,18,31],[61,4,19,2],[62,2,20,0],[62,3,20,1],[64,2,22,0],[65,2,23,7],[65,8,23,13,"trackEvent"],[65,18,23,23],[65,21,23,26],[65,27,23,26,"trackEvent"],[65,28,24,2,"eventType"],[65,37,24,56],[65,39,25,2,"metadata"],[65,47,25,32],[65,52,26,5],[66,4,27,2],[66,8,27,6],[67,6,28,4],[67,12,28,10,"deviceId"],[67,20,28,18],[67,23,28,21],[67,29,28,27,"getDeviceId"],[67,40,28,38],[67,41,28,39],[67,42,28,40],[68,6,29,4],[68,12,29,10,"platform"],[68,20,29,18],[68,23,29,21,"Platform"],[68,31,29,29],[68,32,29,29,"default"],[68,39,29,29],[68,40,29,30,"OS"],[68,42,29,32],[68,43,29,33],[68,44,29,34],[70,6,31,4],[70,12,31,10,"fetch"],[70,17,31,15],[70,18,31,16],[70,21,31,19,"BACKEND_URL"],[70,32,31,30],[70,54,31,52],[70,56,31,54],[71,8,32,6,"method"],[71,14,32,12],[71,16,32,14],[71,22,32,20],[72,8,33,6,"headers"],[72,15,33,13],[72,17,33,15],[73,10,33,17],[73,24,33,31],[73,26,33,33],[74,8,33,52],[74,9,33,53],[75,8,34,6,"body"],[75,12,34,10],[75,14,34,12,"JSON"],[75,18,34,16],[75,19,34,17,"stringify"],[75,28,34,26],[75,29,34,27],[76,10,35,8,"device_id"],[76,19,35,17],[76,21,35,19,"deviceId"],[76,29,35,27],[77,10,36,8,"event_type"],[77,20,36,18],[77,22,36,20,"eventType"],[77,31,36,29],[78,10,37,8,"platform"],[78,18,37,16],[78,20,37,18,"platform"],[78,28,37,26],[79,10,38,8,"app_version"],[79,21,38,19],[79,23,38,21],[79,30,38,28],[80,10,39,8,"metadata"],[80,18,39,16],[80,20,39,18,"metadata"],[81,8,40,6],[81,9,40,7],[82,6,41,4],[82,7,41,5],[82,8,41,6],[83,4,42,2],[83,5,42,3],[83,6,42,4],[83,13,42,11,"error"],[83,18,42,16],[83,20,42,18],[84,6,43,4],[85,6,44,4,"console"],[85,13,44,11],[85,14,44,12,"log"],[85,17,44,15],[85,18,44,16],[85,36,44,34],[85,38,44,36,"error"],[85,43,44,41],[85,44,44,42],[86,4,45,2],[87,2,46,0],[87,3,46,1],[89,2,48,0],[90,2,49,7],[90,8,49,13,"trackAppOpen"],[90,20,49,25],[90,23,49,28,"trackAppOpen"],[90,24,49,28],[90,29,49,34,"trackEvent"],[90,39,49,44],[90,40,49,45],[90,50,49,55],[90,51,49,56],[92,2,51,0],[93,2,52,7],[93,8,52,13,"trackAdClick"],[93,20,52,25],[93,23,52,29,"adId"],[93,27,52,42],[93,31,52,47,"trackEvent"],[93,41,52,57],[93,42,52,58],[93,52,52,68],[93,54,52,70],[94,4,52,72,"ad_id"],[94,9,52,77],[94,11,52,79,"adId"],[95,2,52,84],[95,3,52,85],[95,4,52,86],[97,2,54,0],[98,2,55,7],[98,8,55,13,"trackAffiliateClick"],[98,27,55,32],[98,30,55,36,"partnerId"],[98,39,55,53],[98,43,56,2,"trackEvent"],[98,53,56,12],[98,54,56,13],[98,71,56,30],[98,73,56,32],[99,4,56,34,"partner_id"],[99,14,56,44],[99,16,56,46,"partnerId"],[100,2,56,56],[100,3,56,57],[100,4,56,58],[101,0,56,59],[101,3]],"functionMap":{"names":["<global>","getDeviceId","trackEvent","trackAppOpen","trackAdClick","trackAffiliateClick"],"mappings":"AAA;2BCO;CDY;0BEG;CFuB;4BGG,4BH;4BIG,0DJ;mCKG;0DLC"},"hasCjsExports":false},"type":"js/module"}]}