{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":90},"end":{"line":3,"column":69,"index":159}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"getDeviceId\", {\n    enumerable: true,\n    get: function () {\n      return getDeviceId;\n    }\n  });\n  Object.defineProperty(exports, \"trackEvent\", {\n    enumerable: true,\n    get: function () {\n      return trackEvent;\n    }\n  });\n  Object.defineProperty(exports, \"trackAppOpen\", {\n    enumerable: true,\n    get: function () {\n      return trackAppOpen;\n    }\n  });\n  Object.defineProperty(exports, \"trackAdClick\", {\n    enumerable: true,\n    get: function () {\n      return trackAdClick;\n    }\n  });\n  Object.defineProperty(exports, \"trackAffiliateClick\", {\n    enumerable: true,\n    get: function () {\n      return trackAffiliateClick;\n    }\n  });\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[0], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const DEVICE_ID_KEY = \"@optical_rx_device_id\";\n\n  // Generate or retrieve a persistent device ID\n  const getDeviceId = async () => {\n    try {\n      let deviceId = await AsyncStorage.default.getItem(DEVICE_ID_KEY);\n      if (!deviceId) {\n        // Generate a unique ID for this device\n        deviceId = `${Platform.default.OS}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        await AsyncStorage.default.setItem(DEVICE_ID_KEY, deviceId);\n      }\n      return deviceId;\n    } catch {\n      return `temp-${Date.now()}`;\n    }\n  };\n\n  // Track analytics event\n  const trackEvent = async (eventType, metadata) => {\n    try {\n      const deviceId = await getDeviceId();\n      const platform = Platform.default.OS; // 'ios', 'android', or 'web'\n\n      await fetch(`${BACKEND_URL}/api/analytics/track`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          device_id: deviceId,\n          event_type: eventType,\n          platform: platform,\n          app_version: \"1.0.0\",\n          metadata: metadata\n        })\n      });\n    } catch (error) {\n      // Silently fail - don't interrupt user experience\n      console.log(\"Analytics error:\", error);\n    }\n  };\n\n  // Track app open (call on app launch)\n  const trackAppOpen = () => trackEvent(\"app_open\");\n\n  // Track ad click\n  const trackAdClick = adId => trackEvent(\"ad_click\", {\n    ad_id: adId\n  });\n\n  // Track affiliate click\n  const trackAffiliateClick = partnerId => trackEvent(\"affiliate_click\", {\n    partner_id: partnerId\n  });\n});","lineCount":101,"map":[[12,2,9,0,"Object"],[12,8,9,0],[12,9,9,0,"defineProperty"],[12,23,9,0],[12,24,9,0,"exports"],[12,31,9,0],[13,4,9,0,"enumerable"],[13,14,9,0],[14,4,9,0,"get"],[14,7,9,0],[14,18,9,0,"get"],[14,19,9,0],[15,6,9,0],[15,13,9,0,"getDeviceId"],[15,24,9,0],[16,4,9,0],[17,2,9,0],[18,2,24,0,"Object"],[18,8,24,0],[18,9,24,0,"defineProperty"],[18,23,24,0],[18,24,24,0,"exports"],[18,31,24,0],[19,4,24,0,"enumerable"],[19,14,24,0],[20,4,24,0,"get"],[20,7,24,0],[20,18,24,0,"get"],[20,19,24,0],[21,6,24,0],[21,13,24,0,"trackEvent"],[21,23,24,0],[22,4,24,0],[23,2,24,0],[24,2,50,0,"Object"],[24,8,50,0],[24,9,50,0,"defineProperty"],[24,23,50,0],[24,24,50,0,"exports"],[24,31,50,0],[25,4,50,0,"enumerable"],[25,14,50,0],[26,4,50,0,"get"],[26,7,50,0],[26,18,50,0,"get"],[26,19,50,0],[27,6,50,0],[27,13,50,0,"trackAppOpen"],[27,25,50,0],[28,4,50,0],[29,2,50,0],[30,2,53,0,"Object"],[30,8,53,0],[30,9,53,0,"defineProperty"],[30,23,53,0],[30,24,53,0,"exports"],[30,31,53,0],[31,4,53,0,"enumerable"],[31,14,53,0],[32,4,53,0,"get"],[32,7,53,0],[32,18,53,0,"get"],[32,19,53,0],[33,6,53,0],[33,13,53,0,"trackAdClick"],[33,25,53,0],[34,4,53,0],[35,2,53,0],[36,2,56,0,"Object"],[36,8,56,0],[36,9,56,0,"defineProperty"],[36,23,56,0],[36,24,56,0,"exports"],[36,31,56,0],[37,4,56,0,"enumerable"],[37,14,56,0],[38,4,56,0,"get"],[38,7,56,0],[38,18,56,0,"get"],[38,19,56,0],[39,6,56,0],[39,13,56,0,"trackAffiliateClick"],[39,32,56,0],[40,4,56,0],[41,2,56,0],[42,2,57,59],[42,6,57,59,"_reactNativeWebDistExportsPlatform"],[42,40,57,59],[42,43,57,59,"require"],[42,50,57,59],[42,51,57,59,"_dependencyMap"],[42,65,57,59],[43,2,57,59],[43,6,57,59,"Platform"],[43,14,57,59],[43,17,57,59,"_interopDefault"],[43,32,57,59],[43,33,57,59,"_reactNativeWebDistExportsPlatform"],[43,67,57,59],[44,2,3,0],[44,6,3,0,"_reactNativeAsyncStorageAsyncStorage"],[44,42,3,0],[44,45,3,0,"require"],[44,52,3,0],[44,53,3,0,"_dependencyMap"],[44,67,3,0],[45,2,3,0],[45,6,3,0,"AsyncStorage"],[45,18,3,0],[45,21,3,0,"_interopDefault"],[45,36,3,0],[45,37,3,0,"_reactNativeAsyncStorageAsyncStorage"],[45,73,3,0],[46,2,5,0],[46,8,5,6,"BACKEND_URL"],[46,19,5,17],[46,22,5,20,"process"],[46,29,5,27],[46,30,5,28,"env"],[46,33,5,31],[46,34,5,32,"EXPO_PUBLIC_BACKEND_URL"],[46,57,5,55],[47,2,6,0],[47,8,6,6,"DEVICE_ID_KEY"],[47,21,6,19],[47,24,6,22],[47,47,6,45],[49,2,8,0],[50,2,9,7],[50,8,9,13,"getDeviceId"],[50,19,9,24],[50,22,9,27],[50,28,9,27,"getDeviceId"],[50,29,9,27],[50,34,9,56],[51,4,10,2],[51,8,10,6],[52,6,11,4],[52,10,11,8,"deviceId"],[52,18,11,16],[52,21,11,19],[52,27,11,25,"AsyncStorage"],[52,39,11,37],[52,40,11,37,"default"],[52,47,11,37],[52,48,11,38,"getItem"],[52,55,11,45],[52,56,11,46,"DEVICE_ID_KEY"],[52,69,11,59],[52,70,11,60],[53,6,12,4],[53,10,12,8],[53,11,12,9,"deviceId"],[53,19,12,17],[53,21,12,19],[54,8,13,6],[55,8,14,6,"deviceId"],[55,16,14,14],[55,19,14,17],[55,22,14,20,"Platform"],[55,30,14,28],[55,31,14,28,"default"],[55,38,14,28],[55,39,14,29,"OS"],[55,41,14,31],[55,45,14,35,"Date"],[55,49,14,39],[55,50,14,40,"now"],[55,53,14,43],[55,54,14,44],[55,55,14,45],[55,59,14,49,"Math"],[55,63,14,53],[55,64,14,54,"random"],[55,70,14,60],[55,71,14,61],[55,72,14,62],[55,73,14,63,"toString"],[55,81,14,71],[55,82,14,72],[55,84,14,74],[55,85,14,75],[55,86,14,76,"substr"],[55,92,14,82],[55,93,14,83],[55,94,14,84],[55,96,14,86],[55,97,14,87],[55,98,14,88],[55,100,14,90],[56,8,15,6],[56,14,15,12,"AsyncStorage"],[56,26,15,24],[56,27,15,24,"default"],[56,34,15,24],[56,35,15,25,"setItem"],[56,42,15,32],[56,43,15,33,"DEVICE_ID_KEY"],[56,56,15,46],[56,58,15,48,"deviceId"],[56,66,15,56],[56,67,15,57],[57,6,16,4],[58,6,17,4],[58,13,17,11,"deviceId"],[58,21,17,19],[59,4,18,2],[59,5,18,3],[59,6,18,4],[59,12,18,10],[60,6,19,4],[60,13,19,11],[60,21,19,19,"Date"],[60,25,19,23],[60,26,19,24,"now"],[60,29,19,27],[60,30,19,28],[60,31,19,29],[60,33,19,31],[61,4,20,2],[62,2,21,0],[62,3,21,1],[64,2,23,0],[65,2,24,7],[65,8,24,13,"trackEvent"],[65,18,24,23],[65,21,24,26],[65,27,24,26,"trackEvent"],[65,28,25,2,"eventType"],[65,37,25,56],[65,39,26,2,"metadata"],[65,47,26,32],[65,52,27,5],[66,4,28,2],[66,8,28,6],[67,6,29,4],[67,12,29,10,"deviceId"],[67,20,29,18],[67,23,29,21],[67,29,29,27,"getDeviceId"],[67,40,29,38],[67,41,29,39],[67,42,29,40],[68,6,30,4],[68,12,30,10,"platform"],[68,20,30,18],[68,23,30,21,"Platform"],[68,31,30,29],[68,32,30,29,"default"],[68,39,30,29],[68,40,30,30,"OS"],[68,42,30,32],[68,43,30,33],[68,44,30,34],[70,6,32,4],[70,12,32,10,"fetch"],[70,17,32,15],[70,18,32,16],[70,21,32,19,"BACKEND_URL"],[70,32,32,30],[70,54,32,52],[70,56,32,54],[71,8,33,6,"method"],[71,14,33,12],[71,16,33,14],[71,22,33,20],[72,8,34,6,"headers"],[72,15,34,13],[72,17,34,15],[73,10,34,17],[73,24,34,31],[73,26,34,33],[74,8,34,52],[74,9,34,53],[75,8,35,6,"body"],[75,12,35,10],[75,14,35,12,"JSON"],[75,18,35,16],[75,19,35,17,"stringify"],[75,28,35,26],[75,29,35,27],[76,10,36,8,"device_id"],[76,19,36,17],[76,21,36,19,"deviceId"],[76,29,36,27],[77,10,37,8,"event_type"],[77,20,37,18],[77,22,37,20,"eventType"],[77,31,37,29],[78,10,38,8,"platform"],[78,18,38,16],[78,20,38,18,"platform"],[78,28,38,26],[79,10,39,8,"app_version"],[79,21,39,19],[79,23,39,21],[79,30,39,28],[80,10,40,8,"metadata"],[80,18,40,16],[80,20,40,18,"metadata"],[81,8,41,6],[81,9,41,7],[82,6,42,4],[82,7,42,5],[82,8,42,6],[83,4,43,2],[83,5,43,3],[83,6,43,4],[83,13,43,11,"error"],[83,18,43,16],[83,20,43,18],[84,6,44,4],[85,6,45,4,"console"],[85,13,45,11],[85,14,45,12,"log"],[85,17,45,15],[85,18,45,16],[85,36,45,34],[85,38,45,36,"error"],[85,43,45,41],[85,44,45,42],[86,4,46,2],[87,2,47,0],[87,3,47,1],[89,2,49,0],[90,2,50,7],[90,8,50,13,"trackAppOpen"],[90,20,50,25],[90,23,50,28,"trackAppOpen"],[90,24,50,28],[90,29,50,34,"trackEvent"],[90,39,50,44],[90,40,50,45],[90,50,50,55],[90,51,50,56],[92,2,52,0],[93,2,53,7],[93,8,53,13,"trackAdClick"],[93,20,53,25],[93,23,53,29,"adId"],[93,27,53,42],[93,31,53,47,"trackEvent"],[93,41,53,57],[93,42,53,58],[93,52,53,68],[93,54,53,70],[94,4,53,72,"ad_id"],[94,9,53,77],[94,11,53,79,"adId"],[95,2,53,84],[95,3,53,85],[95,4,53,86],[97,2,55,0],[98,2,56,7],[98,8,56,13,"trackAffiliateClick"],[98,27,56,32],[98,30,56,36,"partnerId"],[98,39,56,53],[98,43,57,2,"trackEvent"],[98,53,57,12],[98,54,57,13],[98,71,57,30],[98,73,57,32],[99,4,57,34,"partner_id"],[99,14,57,44],[99,16,57,46,"partnerId"],[100,2,57,56],[100,3,57,57],[100,4,57,58],[101,0,57,59],[101,3]],"functionMap":{"names":["<global>","getDeviceId","trackEvent","trackAppOpen","trackAdClick","trackAffiliateClick"],"mappings":"AAA;2BCQ;CDY;0BEG;CFuB;4BGG,4BH;4BIG,0DJ;mCKG;0DLC"},"hasCjsExports":false},"type":"js/module"}]}